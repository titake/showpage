<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>信息管理</title>  <!---->
	<link rel="icon" type="image/png" href="../images/icon_star2.png">  <!-- ./是当前目录   ../是上一级父目录    /是根目录  -->
	<link rel="stylesheet" type="text/css" href="../styles/logupCss.css">
	<link rel="stylesheet" type="text/css" href="../styles/mainCss.css">
	<style type="text/css">
		.view_title{
			width: 100%;
			display: flex;
			flex-direction: row;
			align-items: center;
		}
		.view_row{
			display: flex;
			flex-direction: row;
			justify-content: flex-start;
			background: transparent;
			align-items: center;
		}
		.view_column{
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: flex-start;
		}
		.view_directions{
			width: 200px;
			height: 460px;
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: flex-start;
			background-color: rgba(110,110,110,0.9);
			border-right: solid 1px #aaa;
			position: relative;
			left: 0px;
		}
		.view_direction{
			width:190px;
			margin-top: 16px;
			margin-left: 10px;
			display: flex;
			flex-direction: column;
			align-content: flex-start;
		}
		.view_direction_name{
			width: 190px;
			display: flex;
			flex-direction: row;
			justify-content: flex-start;
			align-items: center;
		}
		.ul_direction{
			margin: 0px;
			padding: 0px;
			margin-left: 34px;
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: flex-start;
			cursor:pointer ;
		}
		.li_direction{
			margin: 0px;
			padding: 0px;
			list-style-type: none;
			color: rgb(240,240,240);
			font-size: 14.5px;
			font-family: 宋体;
			font-weight: 200;
			text-align: left;
			height: 20px;
			cursor: pointer;
		}

		.view_content{
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-content: flex-start;
			margin-left: 16px;
			margin-right: 16px;
			width: 968px;
		}
		.view_toolbar{
			margin-top: 16px;
			width: 968px;
			display: flex;
			flex-direction: row;
			justify-content: flex-end;
			align-items: center;
		}
		.view_add{
			display: flex;
			flex-direction: row;
			cursor: pointer;
			justify-content: center;
			align-content: center;
		}
		.input_search{
			margin-left: 60px;
			width: 114px;
			height: 30px;
			padding-left: 6px;
			border: solid 1px #aaa;
			border-right: dashed 1px #ccc;
			border-radius: 3px 0px 0px 3px;
		}
		.select_search{
			margin: 0px;
			padding-left: 6px;
			width: 94px;
			height: 34px;
			border: solid 1px #aaa;
			border-left: none;
			border-radius: 0px 3px 3px 0px;
		}
		.text_option{
			margin: 0px;
			padding-left: 6px;
			width: 94px;
		}
		.ul_content{
			display: flex;
			padding: 0px;
			margin: 0px;
			margin-top: 16px;
			flex-direction: column;
			width: 968px;
			background-color: rgba(255,255,255,0.9);
			border: solid 1px #aaa;
			border-radius: 1px;
		}
		.li_content{
			list-style-type: none;
			padding: 0px;
			margin: 0px;
			width: 948px;
			height: 40px;
			padding-left: 10px;
			padding-right: 10px;
			display: flex;
			flex-direction: row;
			justify-content: space-between;
			align-items: center;
			cursor: pointer;
		}
		/*首页主界面*/
		.text_title1{
			color: rgb(238,238,238);
			font-family: 宋体;
			margin: 0px;
			padding: 0px;
			text-align: left;
			margin-left: 2px;
		}
		.text_title3{
			color: rgb(60,60,60);
			font-family: 宋体;
			font-size: 15px;
			margin: 0px;
			padding: 0px;
		}
		.text_direction{
			color: rgb(240,240,240);
			font-size: 15px;
			font-family: 宋体;
			text-align: left;
			padding: 0px;
			margin: 0px;
		}
		.text_normal{
			color: rgb(60,60,60);
			font-family: 宋体;
			font-size: 15px;
			margin: 0px;
			padding: 0px;
			overflow: hidden;
			text-overflow: ellipsis;
		}
		.p_btn{
			cursor: pointer;
			width: 60px;
			color: rgb(20,20,20);
			font-size: 15px;
			font-family: 宋体;
			text-align: left;
			margin: 0px;
			padding: 0px;
			text-align: center;
		}
	</style>
	<script type="text/javascript" src="../styles/myjs.js"></script>
	<script type="text/javascript" src="../lib/jquery-3.2.0.js"></script>
</head>
<body>
<!--第一行title-->
	<div class="view_title" style="height: 70px;background-color: rgba(40,40,40,0.9);justify-content: space-between;">
		<div class="view_row" style="margin-left: 10px;">
			<img class="img_title" src="../images/icon_star2.png">
			<div class="view_column">
				<p class="text_title1" style="font-size: 22px;">挂牌评星管理系统</p>
				<p class="text_title1" style="font-size: 16px;">titake.xyz</p>
			</div>
		</div>
		<p class="text_title1" style="margin-right: 10px; font-size: 26px;">道路运输挂牌评星管理系统</p>
	</div>
<!--第二行title，显示用户-->
	<div class="view_title" style="height: 40px;background-color: rgba(245,245,245,0.9);justify-content: flex-end;">
		<a class="text_user" id="id_icon_user"  style="margin-right: 50px;" onmouseover="turnToBlur('id_icon_user')" onmouseout="turnToClear('id_icon_user')" onclick="Mytoggle('id_div_userAdmin')"></a>
	</div>
	<ul id="id_div_userAdmin" class="view_userAdmin" style="display: none;top: 112px;background-color: rgba(50,50,50,0.9);">
		<!-- <li id="id_user_edit" class="option_userAdmin" onclick="turnToEdit()"> 
			<img class="img_icon" src="../images/set_white.png"><p class="text_user" style="width: 80px;color: rgb(240,240,240);">个人设置</p>
		</li> -->
		<li id="id_user_admin" class="option_userAdmin" onclick="location.href='admin.html'">
			<img class="img_icon" src="../images/admin_white.png"><p class="text_user" style="width: 80px;color: rgb(240,240,240);">信息管理</p>
		</li>
		<li id="id_user_logout" class="option_userAdmin" style="border-bottom: none;" onclick="logout()">
			<img class="img_icon" src="../images/logout_white.png"><p class="text_user" style="width: 80px;color: rgb(240,240,240);">退出登录</p>
		</li>
	</ul>
<!--第三行title，左边写管理列表，右边写当前是什么管理-->
	<div class="view_title" style="height: 40px;justify-content: flex-start;background-color: rgba(225,225,225,0.9);">
		<div style="display:flex;flex-direction: column; border-right: solid 1px #aaa;height: 40px;justify-content: center;align-items: center;">
			<p class="text_title3" style="width: 200px;text-align: center;">管理员</p>
		</div>
		<p class="text_title3" id="id_title3_right" style="text-align: left;margin-left: 20px;">信息管理</p>
	</div>
<!--首页-->
	<div class="view_main" style="flex-direction: row;justify-content: flex-start;align-items: flex-start;">
	<!--目录-->
		<div class="view_directions">
			<div class="view_direction">
				<div class="view_direction_name" onclick="Mytoggle('id_ul_dirComp')">
					<img class="img_icon" src="../images/plus.png" id="id_img_dirComp">
					<p class="text_direction">企业管理</p>
				</div>
				<ul class="ul_direction" style="display: none;" id="id_ul_dirComp">
					<li class="li_direction" onclick="getCompUL('transComps_person')">客运企业列表</li>
					<li class="li_direction" onclick="getCompUL('transComps_good')">货运企业列表</li>
					<li class="li_direction" onclick="getCompUL('transComps_teach')">驾校列表</li>
					<li class="li_direction" onclick="getCompUL('mainComps')">维护企业列表</li>
					<li class="li_direction" onclick="getCompUL('transports')">客运站列表</li>
				</ul>
			</div>
			<div class="view_direction">
				<div class="view_direction_name" onclick="Mytoggle('id_ul_dirCar')">
					<img class="img_icon" src="../images/plus.png" id="id_img_dirCar">
					<p class="text_direction">车辆管理</p>
				</div>
				<ul class="ul_direction" style="display: none;" id="id_ul_dirCar">
					<li class="li_direction" onclick="getCarUL('taxi')">出租车列表</li>
					<li class="li_direction" onclick="getCarUL('bus')">公交车列表</li>
					<li class="li_direction" onclick="getCarUL('shuttle')">班车列表</li>
					<li class="li_direction" onclick="getCarUL('normal_truck')">普通货车列表</li>
					<li class="li_direction" onclick="getCarUL('danger_truck')">危险品运输车列表</li>
					<li class="li_direction" onclick="getCarUL('student_car')">教练车列表</li>
				</ul>
			</div>
			<div class="view_direction">
				<div class="view_direction_name" onclick="Mytoggle('id_ul_dirDriver')">
					<img class="img_icon" src="../images/plus.png" id="id_img_dirDriver">
					<p class="text_direction">驾驶员管理</p>
				</div>
				<ul class="ul_direction" style="display: none;" id="id_ul_dirDriver">
					<li class="li_direction" onclick="getDriverUl()">驾驶员列表</li>
				</ul>
			</div>
			<!-- <div class="view_direction">
				<div class="view_direction_name" onclick="Mytoggle('id_ul_dirMisdeed')">
					<img class="img_icon" src="../images/plus.png" id="id_img_dirMisdeed">
					<p class="text_direction">违规管理</p>
				</div>
				<ul class="ul_direction" style="display: none;" id="id_ul_dirMisdeed">
					<li class="li_direction" onclick="getUL('misdeed_comp')">企业违规列表</li>
					<li class="li_direction" onclick="getUL('misdeed_driver')">驾驶员违规列表</li>
					<li class="li_direction" onclick="getUL('misdeed_other')">其他员工违规列表</li>
				</ul>
			</div> -->
		</div>
	<!--内容-->
	<!-- 企业管理 -->
		<div class="view_content"  id="id_admin_comp" style="display: none;">
			<!--工具栏-->
			<div class="view_toolbar">
				<div class="view_add" onclick="addComp()"> 
					<img src="../images/add.png" class="img_icon">
					<p class="text_normal">添加企业</p>
				</div>
				<input type="text" class="input_search" id="id_where_comp">
				<select class="select_search" id="id_comp_options">
					<option class="text_option">企业名</option>
					<option class="text_option">法人名</option>
					<option class="text_option">主要负责人</option>
				</select>
				<img src="../images/search.png" class="img_icon" style="margin-left: 6px;cursor: pointer;" onclick="searchComp()">
			</div>
			<!-- 内容列表 -->
			<ul class="ul_content" id="id_ul_comps">
			</ul>
		</div>
	<!-- 车辆管理 -->
		<div class="view_content" style="display: none;" id="id_admin_car">
			<!--工具栏-->
			<div class="view_toolbar">
				<div class="view_add" onclick="addCar()"> 
					<img src="../images/add.png" class="img_icon">
					<p class="text_normal">添加车辆</p>
				</div>
				<input type="text" class="input_search" id="id_where_car">
				<select class="select_search" id="id_options_cars">
					<option class="text_option">车牌号</option>
					<option class="text_option">车辆类型</option>
					<option class="text_option">所属单位</option>
					<option class="text_option">驾驶员姓名</option>
					<option class="text_option">档案编号</option>
					<option class="text_option">发动机号</option>
					<option class="text_option">车辆识别号</option>
				</select>
				<img src="../images/search.png" class="img_icon" style="margin-left: 6px;cursor: pointer;" onclick="searchCar()">
			</div>
			<!-- 内容列表 -->
			<ul class="ul_content" id="id_ul_car">
				<li class="li_content">
				</li>
			</ul>
		</div>
	<!-- 驾驶员管理 -->
		<div class="view_content" style="display: none;" id="id_admin_driver">
			<!--工具栏-->
			<div class="view_toolbar">
				<div class="view_add" onclick="addDriver()"> 
					<img src="../images/add.png" class="img_icon">
					<p class="text_normal">添加驾驶员</p>
				</div>
				<input type="text" class="input_search" id="id_where_driver">
				<select class="select_search" id="id_options_driver">
					<option class="text_option">姓名</option>
					<option class="text_option">性别</option>
					<option class="text_option">驾驶证号</option>
					<option class="text_option">档案编号</option>
					<option class="text_option">从业资格证号</option>
					<option class="text_option">联系电话</option>
				</select>
				<img src="../images/search.png" class="img_icon" style="margin-left: 6px;cursor: pointer;" onclick="searchDriver()">
			</div>
			<!-- 内容列表 -->
			<ul class="ul_content" id="id_ul_drivers">
				<li class="li_content">
				</li>
			</ul>
		</div>
	</div>
	<div class="view_footer">
		<p class="text_footer">Copyright © 2016-2017 titake All Rights Reserved.</p>
		<img src="../images/star_gray.png" title="star_polite1">
	</div>
	
	<script type="text/javascript">
		user_email="";
		usertype = "";
		var request = new XMLHttpRequest;
		request.open("GET","../ajax/queryCookie.php?name=user_email",true);
		request.send();
		request.onreadystatechange = function(){
			if (request.readyState===4) {
				if (request.status===200) {
					var result = JSON.parse(request.responseText);
					if (result.success) {
						user_email=result.value;
						request.open("GET","../ajax/getData_sql.php?flag=userType&user_email="+user_email,true);
						request.send();
						request.onreadystatechange = function(){
							if (request.readyState===4) {
								if (request.status===200) {
									var result = JSON.parse(request.responseText);
									usertype = result.userType;
									if (usertype!="超级管理员")
										window.location.href="hello.html";
								}else{
									alert("error:"+request.status);
								}
							}
						}
						$(function(){
							$("#id_icon_user").html(result.value);
						});
					}else{
						window.location.href="login.html";
					}
				}else{
					alert("error:"+request.status);
				}
			}
		}
	//交替显示与隐藏对象
		function Mytoggle(elementID){
			$(function(){
				$("#"+elementID).toggle("normal");
				if (elementID.search(/^id_ul_dir/g)>=0) {
					var imgId = "#id_img_dir"+elementID.split(/^id_ul_dir/g)[1];
					if ($(imgId).attr("src")=="../images/plus.png") {
						$(imgId).attr("src","../images/minus.png");
					}else{
						$(imgId).attr("src","../images/plus.png");
					}
				}
			});
		}
	//title中的用户的个人信息设置点击事件
		// function turnToEdit(){
		// 	switch(usertype) {
		// 		case '驾驶员/教练员':
		// 			window.location.href='logup_Step2_driver.html?';
		// 			break;
		// 		case '维修工人':
		// 			window.location.href='show_maintainer_one.html?type=edit';
		// 			break; 
		// 		case '客运站员工':
		// 			window.location.href='show_staff_one.html?type=edit';
		// 			break; 
		// 		case '运输公司/驾校管理人员':
		// 			window.location.href='show_administer_one.html?type=edit';
		// 			break; 
		// 		case '维护公司管理人员':
		// 			window.location.href='show_administer_one.html?type=edit';
		// 			break; 
		// 		case '客运站管理人员':
		// 			window.location.href='show_administer_one.html?type=edit';
		// 			break; 
		// 		case '超级管理员':
		// 			window.location.href='show_administer_one.html?type=edit';
		// 			break; 
		// 		case '乘客/学员':
		// 			window.location.href='show_passenger_one.html?type=edit';
		// 			break; 
		// 	}
		// }
	//企业管理
		function getCompUL(FLAG){
			switch (FLAG) {
				case 'transComps_person':
					$(function(){
						$("#id_title3_right").html('客运企业列表');
						$(".view_content").hide();
						$("#id_comp_options").html('<option class="text_option">企业名</option> <option class="text_option">法人名</option>	<option class="text_option">主要负责人</option>');
					});
					break;
				case 'transComps_good':
					$(function(){
						$("#id_title3_right").html('货运企业列表');
						$(".view_content").hide();
						$("#id_comp_options").html('<option class="text_option">企业名</option> <option class="text_option">法人名</option>	<option class="text_option">主要负责人</option>');
					});
					break;
				case 'transComps_teach':
					$(function(){
						$("#id_title3_right").html('驾校列表');
						$(".view_content").hide();
						$("#id_comp_options").html('<option class="text_option">企业名</option> <option class="text_option">法人名</option>	<option class="text_option">主要负责人</option>');
					});
					break;
				case 'mainComps':
					$(function(){
						$("#id_title3_right").html('维护企业列表');
						$(".view_content").hide();
						$("#id_comp_options").html('<option class="text_option">企业名</option> <option class="text_option">法人名</option>	<option class="text_option">主要负责人</option>');
					});
					break;
				case 'transports':
					$(function(){
						$("#id_title3_right").html('客运站列表');
						$(".view_content").hide();
						$("#id_comp_options").html('<option class="text_option">企业名</option> <option class="text_option">主要负责人</option>');  
					});
					break;
			}
			var request = new XMLHttpRequest;
			request.open("GET","../ajax/getData_sql.php?flag="+FLAG,true);
			request.send();
			request.onreadystatechange = function(){
				if (request.readyState===4) {
					if (request.status===200) {
						var result = JSON.parse(request.responseText);
						var inner="";
						if (result.length>0) {
							if (FLAG=="transports") {
								for (var i = 0; i<result.length; i++) {
									var j = "list"+i;
									inner = inner+'<li class="li_content"><p class="text_normal" title="name" style="width: 150px;">'+result[j]['name']+'</p><p class="text_normal" title="address" style="width: 578px;margin-left: 50px;">'+result[j]['location']+'</p><p class="p_btn" title="li_edit" style="margin-left: 50px;">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
								}
							}else{
								for (var i = 0; i<result.length; i++) {
									var j = "list"+i;
									inner = inner+'<li class="li_content"><p class="text_normal" title="name" style="width: 150px;">'+result[j]['name']+'</p><p class="text_normal" title="address" style="width: 578px;margin-left: 50px;">'+result[j]['registe_address']+'</p><p class="p_btn" title="li_edit" style="margin-left: 50px;">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
								}
							}
						}else{
							console.log(result.reason);
						}
						$(function(){
							$("#id_ul_comps").html(inner);
							$("#id_ul_comps >li:even").css("background-color","rgba(220,220,220,0.8)");
							$("#id_ul_comps >li").mouseover(function(){$(this).css("background-color","rgba(230,230,230,0.9)")});
							$("#id_ul_comps >li:even").mouseout(function(){$(this).css("background-color","rgba(220,220,220,0.8)")});
							$("#id_ul_comps >li:odd").mouseout(function(){$(this).css("background-color","rgba(250,250,250,0.9)")});
							$("#id_ul_comps >li>p[title='name']").click(function(){
								var name = $(this).html();
								switch($("#id_title3_right").html()){
									case '客运企业列表':
									case '货运企业列表':
									case '驾校列表':
										window.open(encodeURI("show_transComp_one.html?compname="+name),"_blank");
										break;
									case '维护企业列表':
										window.open(encodeURI("show_mainComp_one.html?compname="+name),"_blank");
										break;
									case '客运站列表':
										window.open(encodeURI("show_transport_one.html?compname="+name),"_blank");
										break;
								}
							});
							$("#id_ul_comps >li>p[title='address']").click(function(){
								var name = $(this).prev().html();
								switch($("#id_title3_right").html()){
									case '客运企业列表':
									case '货运企业列表':
									case '驾校列表':
										window.open(encodeURI("show_transComp_one.html?compname="+name),"_blank");
										break;
									case '维护企业列表':
										window.open(encodeURI("show_mainComp_one.html?compname="+name),"_blank");
										break;
									case '客运站列表':
										window.open(encodeURI("show_transport_one.html?compname="+name),"_blank");
										break;
								}
							});
							$("#id_ul_comps >li>p[title='li_edit']").click(function(){
								var name = $(this).prevAll('p[title=name]').html();
								switch($("#id_title3_right").html()){
									case '客运企业列表':
									case '货运企业列表':
									case '驾校列表':
										window.open(encodeURI("add_transComp.html?usertype=super&name="+name),"_blank");
										break;
									case '维护企业列表':
										window.open(encodeURI("add_maintComp.html?usertype=super&name="+name),"_blank");
										break;
									case '客运站列表':
										window.open(encodeURI("add_transport.html?usertype=super&compname="+name),"_blank");
										break;
								}
							});
							$("#id_ul_comps >li>p[title='li_delete']").click(function(){
								if (window.confirm("确认注销该企业？")) {
									var name = $(this).prevAll('p[title=name]').html();
									switch($("#id_title3_right").html()){
										case '客运企业列表':
										case '货运企业列表':
										case '驾校列表':
											var flag = "delete_transComp";
											break;
										case '维护企业列表':
											var flag = "delete_mainComp";
											break;
										case '客运站列表':
											var flag = "delete_transport";
											break;
									}
									var request = new XMLHttpRequest;
									request.open("POST","../ajax/WriteDB.php",true);
									request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
									request.send("name="+name+"&flag="+flag);
									request.onreadystatechange = function(){
										if (request.readyState===4) {
											if (request.status===200) {
												var response = request.responseText;
												alert(response);
												if (response=="注销成功") {
													switch($("#id_title3_right").html()){
														case '客运企业列表':
															var flag = "transComps_person";
															break;
														case '货运企业列表':
															var flag = "transComps_good";
															break;
														case '驾校列表':
															var flag = "transComps_teach";
															break;
														case '维护企业列表':
															var flag = "mainComps";
															break;
														case '客运站列表':
															var flag = "transports";
															break;
													}
													getCompUL(flag);
												}
											}else{
												alert("error:"+request.status);
											}
										}
									}
								}
							});
							$("#id_admin_comp").css("display","flex");
						});
					}else{
						alert("error:"+request.status);
					}
				}
			}
		}
		function addComp(){
			switch(document.getElementById("id_title3_right").innerHTML){
				case '客运企业列表':
				case '货运企业列表':
				case '驾校列表':
					window.open(encodeURI("add_transComp.html?usertype=super"),"_blank");
					break;
				case '维护企业列表':
					window.open(encodeURI("add_maintComp.html?usertype=super"),"_blank");
					break;
				case '客运站列表':
					window.open(encodeURI("add_transport.html?usertype=super"),"_blank");
					break;
			}
		}
		function searchComp(){
			var selectOptions = document.getElementById("id_comp_options");
			var sindex = selectOptions.selectedIndex;
			var reference = selectOptions.options[sindex].value;
			var sql;
			switch(document.getElementById("id_title3_right").innerHTML){
				case '客运企业列表':
					sql = "select name,registe_address from tb_transcomp where scope like '%person%' and ";
					break;
				case '货运企业列表':
					sql = "select name,registe_address from tb_transcomp where scope like '%good%' and ";
					break;
				case '驾校列表':
					sql = "select name,registe_address from tb_transcomp where scope like '%teach%' and ";
					break;
				case '维护企业列表':
					sql = "select name,registe_address from tb_maincomp where ";
					break;
				case '客运站列表':
					sql = "select name,location from tb_transport where ";
					break;
			}
			var where = document.getElementById("id_where_comp").value;
			switch(reference){
				case '企业名':
					reference = "name";
					break;
				case '法人名':
					reference = "corporation";
					break;
				case '主要负责人':
					reference = "charge_person";
					break;
			}
			sql = sql +reference+" like '%"+where+"%';";
			var request = new XMLHttpRequest;
			request.open("GET","../ajax/getData_sql.php?flag=dosql&sql="+sql,true);
			request.send();
			request.onreadystatechange = function(){
				if (request.readyState===4) {
					if (request.status===200) {
						var result = JSON.parse(request.responseText);
						var inner="";
						if (result.length>0) {
							if (document.getElementById("id_title3_right").innerHTML=="客运站列表") {
								for (var i = 0; i<result.length; i++) {
									var j = "list"+i;
									inner = inner+'<li class="li_content"><p class="text_normal" title="name" style="width: 150px;">'+result[j]['name']+'</p><p class="text_normal" title="address" style="width: 578px;margin-left: 50px;">'+result[j]['location']+'</p><p class="p_btn" title="li_edit" style="margin-left: 50px;">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
								}
							}else{
								for (var i = 0; i<result.length; i++) {
									var j = "list"+i;
									inner = inner+'<li class="li_content"><p class="text_normal" title="name" style="width: 150px;">'+result[j]['name']+'</p><p class="text_normal" title="address" style="width: 578px;margin-left: 50px;">'+result[j]['registe_address']+'</p><p class="p_btn" title="li_edit" style="margin-left: 50px;">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
								}
							}
						}else{
							console.log(result.reason);
						}
						$(function(){
							$("#id_ul_comps").html(inner);
							$("#id_ul_comps >li:even").css("background-color","rgba(220,220,220,0.8)");
							$("#id_ul_comps >li").mouseover(function(){$(this).css("background-color","rgba(230,230,230,0.9)")});
							$("#id_ul_comps >li:even").mouseout(function(){$(this).css("background-color","rgba(220,220,220,0.8)")});
							$("#id_ul_comps >li:odd").mouseout(function(){$(this).css("background-color","rgba(250,250,250,0.9)")});
							$("#id_ul_comps >li>p[title='name']").click(function(){
								var name = $(this).html();
								switch($("#id_title3_right").html()){
									case '客运企业列表':
									case '货运企业列表':
									case '驾校列表':
										window.open(encodeURI("show_transComp_one.html?compname="+name),"_blank");
										break;
									case '维护企业列表':
										window.open(encodeURI("show_mainComp_one.html?compname="+name),"_blank");
										break;
									case '客运站列表':
										window.open(encodeURI("show_transport_one.html?compname="+name),"_blank");
										break;
								}
							});
							$("#id_ul_comps >li>p[title='address']").click(function(){
								var name = $(this).prev().html();
								switch($("#id_title3_right").html()){
									case '客运企业列表':
									case '货运企业列表':
									case '驾校列表':
										window.open(encodeURI("show_transComp_one.html?compname="+name),"_blank");
										break;
									case '维护企业列表':
										window.open(encodeURI("show_mainComp_one.html?compname="+name),"_blank");
										break;
									case '客运站列表':
										window.open(encodeURI("show_transport_one.html?compname="+name),"_blank");
										break;
								}
							});
							$("#id_ul_comps >li>p[title='li_edit']").click(function(){
								var name = $(this).prevAll('p[title=name]').html();
								switch($("#id_title3_right").html()){
									case '客运企业列表':
									case '货运企业列表':
									case '驾校列表':
										window.open(encodeURI("add_transComp.html?usertype=super&name="+name),"_blank");
										break;
									case '维护企业列表':
										window.open(encodeURI("add_maintComp.html?usertype=super&name="+name),"_blank");
										break;
									case '客运站列表':
										window.open(encodeURI("add_transport.html?usertype=super&compname="+name),"_blank");
										break;
								}
							});
							$("#id_ul_comps >li>p[title='li_delete']").click(function(){
								if (window.confirm("确认注销该企业？")) {
									var name = $(this).prevAll('p[title=name]').html();
									switch($("#id_title3_right").html()){
										case '客运企业列表':
										case '货运企业列表':
										case '驾校列表':
											var flag = "delete_transComp";
											break;
										case '维护企业列表':
											var flag = "delete_mainComp";
											break;
										case '客运站列表':
											var flag = "delete_transport";
											break;
									}
									var request = new XMLHttpRequest;
									request.open("POST","../ajax/WriteDB.php",true);
									request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
									request.send("name="+name+"&flag="+flag);
									request.onreadystatechange = function(){
										if (request.readyState===4) {
											if (request.status===200) {
												var response = request.responseText;
												alert(response);
												if (response=="删除成功") {
													switch($("#id_title3_right").html()){
														case '客运企业列表':
															var flag = "transComps_person";
															break;
														case '货运企业列表':
															var flag = "transComps_good";
															break;
														case '驾校列表':
															var flag = "transComps_teach";
															break;
														case '维护企业列表':
															var flag = "mainComps";
															break;
														case '客运站列表':
															var flag = "transports";
															break;
													}
													getCompUL(flag);
												}
											}else{
												alert("error:"+request.status);
											}
										}
									}
								}
							});
							$("#id_admin_comp").css("display","flex");
						});
					}else{
						alert("error:"+request.status);
					}
				}
			}
		}
	//车辆管理
		function getCarUL(CarType){
			switch(CarType){
				case 'taxi':
					$(function(){
						$("#id_title3_right").html("出租车列表");
						$(".view_content").hide();
						$("#id_options_cars").html('<option class="text_option">车牌号</option><option class="text_option">车型</option>	<option class="text_option">所属单位</option><option class="text_option">驾驶员姓名</option><option class="text_option">档案编号</option><option class="text_option">发动机号</option><option class="text_option">车辆识别号</option>');
					});
					break;
				case 'bus':
					$(function(){
						$("#id_title3_right").html("公交车列表");
						$(".view_content").hide();
						$("#id_options_cars").html('<option class="text_option">车牌号</option><option class="text_option">车型</option>	<option class="text_option">所属单位</option><option class="text_option">驾驶员姓名</option><option class="text_option">档案编号</option><option class="text_option">发动机号</option><option class="text_option">车辆识别号</option>');
					});
					break;
				case 'shuttle':
					$(function(){
						$("#id_title3_right").html("班车列表");
						$(".view_content").hide();
						$("#id_options_cars").html('<option class="text_option">车牌号</option><option class="text_option">车型</option>	<option class="text_option">所属单位</option><option class="text_option">驾驶员姓名</option><option class="text_option">档案编号</option><option class="text_option">发动机号</option><option class="text_option">车辆识别号</option>');
					});
					break;
				case 'normal_truck':
					$(function(){
						$("#id_title3_right").html("普通货车列表");
						$(".view_content").hide();
						$("#id_options_cars").html('<option class="text_option">车牌号</option><option class="text_option">车型</option>	<option class="text_option">所属单位</option><option class="text_option">驾驶员姓名</option><option class="text_option">档案编号</option><option class="text_option">发动机号</option><option class="text_option">车辆识别号</option>');
					});
					break;
				case 'danger_truck':
					$(function(){
						$("#id_title3_right").html("危险品运输车列表");
						$(".view_content").hide();
						$("#id_options_cars").html('<option class="text_option">车牌号</option><option class="text_option">车型</option>	<option class="text_option">所属单位</option><option class="text_option">驾驶员姓名</option><option class="text_option">发动机号</option><option class="text_option">车辆识别号</option>');
					});
					break;
				case 'student_car':
					$(function(){
						$("#id_title3_right").html("教练车列表");
						$(".view_content").hide();
						$("#id_options_cars").html('<option class="text_option">车牌号</option><option class="text_option">车型</option>	<option class="text_option">所属单位</option><option class="text_option">驾驶员姓名</option><option class="text_option">发动机号</option><option class="text_option">车辆识别号</option>');
					});
					break;
			}
			var sql = "select plate_num,car_classify,driver1,driver2,img from ";
			sql=sql+"tb_"+CarType;
			var request = new XMLHttpRequest;
			request.open("GET","../ajax/getData_sql.php?flag=cars&sql="+sql,true);
			request.send();
			request.onreadystatechange = function(){
				console.log(CarType);
				if (request.readyState===4) {
					if (request.status===200) {
						var result = JSON.parse(request.responseText);
						var inner="";
						if (result.length>0) {
							for (var i = 0; i<result.length; i++) {
								var j = "list"+i;
								inner = inner+'<li class="li_content" index="'+i+'"><p class="text_normal" title="plate_num" style="width: 80px;">'+result[j]['plate_num']+'</p><p class="text_normal" title="car_classify" style="width: 100px;margin-left: 50px;">'+result[j]['car_classify']+'</p><p class="text_normal" title="driver1" style="width: 165px;margin-left: 50px;">'+result[j]['driver1']+'</p><p class="text_normal" title="driver2" style="width: 165px;margin-left: 50px;">'+result[j]['driver2']+'</p><p title="img" style="display:none;">'+result[j]['img']+'</p><p class="p_btn" title="li_edit" style="margin-left: 118px;">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
							}
						}else{
							console.log(result.reason);
						}
						$(function(){
							$("#id_ul_car").html(inner);
							$("#id_ul_car >li:even").css("background-color","rgba(220,220,220,0.8)");
							$("#id_ul_car >li").mouseover(function(){$(this).css("background-color","rgba(230,230,230,0.9)")});
							$("#id_ul_car >li:even").mouseout(function(){$(this).css("background-color","rgba(220,220,220,0.8)")});
							$("#id_ul_car >li:odd").mouseout(function(){$(this).css("background-color","rgba(250,250,250,0.9)")});
							$("#id_ul_car >li>p[title='driver1']").prevAll('p[title=plate_num]').click(function(){
								var plate_num = $(this).html();
								window.open(encodeURI("show_car_one.html?cartype="+CarType+"&plate_num="+plate_num),"_blank");
							});
							$("#id_ul_car >li>p[title='driver1']").prevAll('p[title=car_classify]').click(function(){
								var plate_num = $(this).prev().html();
								window.open(encodeURI("show_car_one.html?cartype="+CarType+"&plate_num="+plate_num),"_blank");
							});
							$("#id_ul_car >li>p[title='driver1']").click(function(){
								if ($(this).html()!="") {
									window.open("show_driver_one.html?sessionName=li_"+$(this).parent().attr("index")+"driver1","_blank");
								}
							});
							$("#id_ul_car >li>p[title='driver2']").click(function(){
								if ($(this).html()!="") {
									window.open("show_driver_one.html?sessionName=li_"+$(this).parent().attr("index")+"driver2","_blank");
								}
							});
							$("#id_ul_car >li>p[title='li_edit']").click(function(){
								var img = $(this).prevAll("p[title=img]").html();
								var plate_num = $(this).prevAll("p[title=plate_num]").html();
								window.open(encodeURI("add_car.html?cartype="+CarType+"&upload="+img+"&edit=true&plate_num="+plate_num),"_blank");    //这里能取到CarType这个相对于该函数而言的全局变量的值（是形参传进来的）
							});
							$("#id_ul_car >li>p[title='li_delete']").click(function(){
								if (window.confirm("确认删除该车辆？")) {
									var plate_num = $(this).prevAll('p[title=plate_num]').html();
									var sql = "delete from tb_"+CarType+" where plate_num='"+plate_num+"';";
									var request = new XMLHttpRequest;
									request.open("POST","../ajax/WriteDB.php",true);
									request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
									request.send("flag=dosql&sql="+sql);
									request.onreadystatechange = function(){
										if (request.readyState===4) {
											if (request.status===200) {
												var response = JSON.parse(request.responseText);
												if (response.success==true) {
													alert("删除成功");
													getCarUL(CarType);
												}else{
													console.log(response.reason);
													alert("删除失败"+response.reason);
												}
											}else{
												alert("error:"+request.status);
											}
										}
									}
								}
							});
							$("#id_admin_car").css("display","flex");
						});
					}else{
						alert("error:"+request.status);
					}
				}
			}
		}
		function addCar(){
			var flag;
			switch(document.getElementById("id_title3_right").innerHTML){
				case '出租车列表':
					flag = "taxi";
					break;
				case '公交车列表':
					flag = "bus";
					break;
				case '班车列表':
					flag = "shuttle";
					break;
				case '普通货车列表':
					flag = "normal_truck";
					break;
				case '危险品运输车列表':
					flag = "danger_truck";
					break;
				case '教练车列表':
					flag = "student_car";
					break;
			}
			window.open(encodeURI("add_car.html?cartype="+flag+"&success="),"_blank");
		}
		function searchCar(){
			var flag;
			var sql = "";
			var tbName = "";
			var CarType;
			switch(document.getElementById("id_title3_right").innerHTML){
				case '出租车列表':
					CarType="taxi";
					break;
				case '公交车列表':
					CarType="bus";
					break;
				case '班车列表':
					CarType="shuttle";
					break;
				case '普通货车列表':
					CarType="normal_truck";
					break;
				case '危险品运输车列表':
					CarType="danger_truck";
					break;
				case '教练车列表':
					CarType="student_car";
					break;	
			}
			switch(document.getElementById("id_title3_right").innerHTML){
				case '出租车列表':
					tbName = "tb_taxi";
					sql = "select plate_num,car_classify,driver1,driver2,img from tb_taxi where ";
					break;
				case '公交车列表':
					tbName = "tb_bus";
					sql = "select plate_num,car_classify,driver1,driver2,img from tb_bus where ";
					break;
				case '班车列表':
					tbName = "tb_shuttle";
					sql = "select plate_num,car_classify,driver1,driver2,img from tb_shuttle where ";
					break;
				case '普通货车列表':
					tbName = "tb_normal_truck";
					sql = "select plate_num,car_classify,driver1,driver2,img from tb_normal_truck where ";
					break;
				case '危险品运输车列表':
					tbName = "tb_danger_truck";
					sql = "select plate_num,car_classify,driver1,driver2,img from tb_danger_truck where ";
					break;
				case '教练车列表':
					tbName = "tb_student_car";
					sql = "select plate_num,car_classify,driver1,driver2,img from tb_student_car where ";
					break;
			}
			var selectOptions = document.getElementById("id_options_cars");
			var sindex = selectOptions.selectedIndex;
			var reference = selectOptions.options[sindex].value;
			var where = document.getElementById("id_where_car").value;
			var flag = "cars";
			switch(reference){
				case '车牌号':
					sql = sql+"plate_num like '%"+where+"%';";
					break;
				case '车型':
					sql = sql+"car_classify like '%"+where+"%';";
					break;
				case '所属单位':
					sql = sql+"comp_name like '%"+where+"%';";
					break;
				case '驾驶员姓名':
					sql = "select idcard_num from tb_driver where username like '%"+where+"%';"
					flag = "searchcar_username";
					break;
				case '档案编号':
					sql = sql+"file_num like '%"+where+"%';";
					break;
				case '发动机号':
					sql = sql+"engine_num like '%"+where+"%';";
					break;
				case '车辆识别号':
					sql = sql+"vin like '%"+where+"%';";
					break;
			}
			var request = new XMLHttpRequest;
			request.open("GET","../ajax/getData_sql.php?flag="+flag+"&sql="+sql+"&tbName="+tbName,true);
			request.send();
			request.onreadystatechange = function(){
				if (request.readyState===4) {
					if (request.status===200) {
						var result = JSON.parse(request.responseText);
						var inner="";
						if (result.length>0) {
							for (var i = 0; i<result.length; i++) {
								var j = "list"+i;
								inner = inner+'<li class="li_content" index="'+i+'"><p class="text_normal" title="plate_num" style="width: 80px;">'+result[j]['plate_num']+'</p><p class="text_normal" title="car_classify" style="width: 100px;margin-left: 50px;">'+result[j]['car_classify']+'</p><p class="text_normal" title="driver1" style="width: 165px;margin-left: 50px;">'+result[j]['driver1']+'</p><p class="text_normal" title="driver2" style="width: 165px;margin-left: 50px;">'+result[j]['driver2']+'</p><p title="img" style="display:none;">'+result[j]['img']+'</p><p class="p_btn" title="li_edit" style="margin-left: 118px;">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
							}
						}else{
							console.log(result.reason);
						}
						$(function(){
							$("#id_ul_car").html(inner);
							$("#id_ul_car >li:even").css("background-color","rgba(220,220,220,0.8)");
							$("#id_ul_car >li").mouseover(function(){$(this).css("background-color","rgba(230,230,230,0.9)")});
							$("#id_ul_car >li:even").mouseout(function(){$(this).css("background-color","rgba(220,220,220,0.8)")});
							$("#id_ul_car >li:odd").mouseout(function(){$(this).css("background-color","rgba(250,250,250,0.9)")});
							$("#id_ul_car >li>p[title='driver1']").prevAll('p[title=plate_num]').click(function(){
								var plate_num = $(this).html();
								window.open(encodeURI("show_car_one.html?cartype="+CarType+"&plate_num="+plate_num),"_blank");
							});
							$("#id_ul_car >li>p[title='driver1']").prevAll('p[title=car_classify]').click(function(){
								var plate_num = $(this).prev().html();
								window.open(encodeURI("show_car_one.html?cartype="+CarType+"&plate_num="+plate_num),"_blank");
							});
							$("#id_ul_car >li>p[title='driver1']").click(function(){
								if ($(this).html()!="") {
									window.open("show_driver_one.html?sessionName=li_"+$(this).parent().attr("index")+"driver1","_blank");
								}
							});
							$("#id_ul_car >li>p[title='driver2']").click(function(){
								if ($(this).html()!="") {
									window.open("show_driver_one.html?sessionName=li_"+$(this).parent().attr("index")+"driver2","_blank");
								}
							});
							$("#id_ul_car >li>p[title='li_edit']").click(function(){
								console.log("CarType:"+CarType);
								var img = $(this).prevAll("p[title=img]").html();
								var plate_num = $(this).prevAll("p[title=plate_num]").html();
								window.open(encodeURI("add_car.html?cartype="+CarType+"&upload="+img+"&edit=true&plate_num="+plate_num),"_blank");
							});
							$("#id_ul_car >li>p[title='li_delete']").click(function(){
								if (window.confirm("确认删除该车辆？")) {
									var plate_num = $(this).prevAll('p[title=plate_num]').html();
									var sql = "delete from tb_"+CarType+" where plate_num='"+plate_num+"';";
									var request = new XMLHttpRequest;
									request.open("POST","../ajax/WriteDB.php",true);
									request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
									request.send("flag=dosql&sql="+sql);
									request.onreadystatechange = function(){
										if (request.readyState===4) {
											if (request.status===200) {
												var response = JSON.parse(request.responseText);
												if (response.success==true) {
													alert("删除成功");
													getCarUL(CarType);
												}else{
													console.log(response.reason);
													alert("删除失败"+response.reason);
												}
											}else{
												alert("error:"+request.status);
											}
										}
									}
								}
							});
							$("#id_admin_car").css("display","flex");
						});
					}else{
						alert("error:"+request.status);
					}
				}
			}
		}

	//驾驶员管理
		function getDriverUl(){
			$(function(){
				$(".view_content").hide();
				$("#id_title3_right").html("驾驶员列表");
			})
			var sql = "select idcard_num,username,sex,job_permi_classify,ifblock,star_polite,star_safe,star_law,star_honest,star_server from tb_driver;";
			var request = new XMLHttpRequest;
			request.open("GET","../ajax/getData_sql.php?flag=drivers&sql="+sql,true);
			request.send();
			request.onreadystatechange = function(){
				if (request.readyState===4) {
					if (request.status===200) {
						var result = JSON.parse(request.responseText);
						var inner="";
						if (result.length>0) {
							inner = inner+'<li class="li_content" style="border-bottom:solid 1px #888;justify-content:flex-start;"><p class="text_normal" style="width: 80px;">姓名</p><p class="text_normal" style="width: 40px;margin-left: 10px;">性别</p><p class="text_normal" style="width: 140px;margin-left: 20px;margin-right:25px;">从业资格类别</p><p class="text_normal" style="width: 83px;text-align:center;">文明星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">安全星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">守法星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">诚信星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">服务星</p></li>';
							for (var m = 0; m<result.length; m++) {
								var j = "list"+m;
								inner = inner+'<li class="li_content" index="'+m+'"><p class="text_normal" style="width: 90px;">'+result[j]['username']+'</p><p class="text_normal" style="width: 15px;margin-left: 20px;">'+result[j]['sex']+'</p><p class="text_normal" style="width: 140px;margin-left: 20px;margin-right:25px;">'+result[j]['job_permi_classify']+'</p>';
								var ifblock = result[j]['ifblock'];
								if (ifblock==1) {
									inner = inner+'<p class="text_normal" style="width: 430px;margin-left: 20px;">该驾驶员在黑名单中';
								}else{
									var star_polite = result[j]['star_polite'];
									var i=1;
									while(i<=star_polite){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_polite++;
									while(star_polite<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_polite++;
									}

									var star_safe = result[j]['star_safe'];
									if (star_safe>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										star_safe++;
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
									}
									i=2;
									while(i<=star_safe){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_safe++;
									while(star_safe<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_safe++;
									}
									var star_law = result[j]['star_law'];
									if (star_law>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
										star_law++;
									}
									i=2;
									while(i<=star_law){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_law++;
									while(star_law<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_law++;
									}
									var star_honest = result[j]['star_honest'];
									if (star_honest>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
										star_honest++
									}
									i=2;
									while(i<=star_honest){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_honest++;
									while(star_honest<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_honest++;
									}
									var star_server = result[j]['star_server'];
									if (star_server>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
										star_server++;
									}
									i=2;
									while(i<=star_server){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_server++;
									while(star_server<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_server++
									}
								}
								inner = inner+ '<p class="p_btn" title="li_edit">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
							}
						}else{
							console.log(result.reason);
						}
						$(function(){
							$("#id_ul_drivers").html(inner);
							$("#id_ul_drivers >li:even").css("background-color","rgba(220,220,220,0.8)");
							$("#id_ul_drivers >li").mouseover(function(){$(this).css("background-color","rgba(230,230,230,0.9)")});
							$("#id_ul_drivers >li:even").mouseout(function(){$(this).css("background-color","rgba(220,220,220,0.8)")});
							$("#id_ul_drivers >li:odd").mouseout(function(){$(this).css("background-color","rgba(250,250,250,0.9)")});
							$("#id_ul_drivers >li>p[title='li_edit']").prevAll().click(function(){
								window.open("show_driver_one.html?sessionName=idcard_num"+$(this).parent().attr("index"),"_blank");
							});
							$("#id_ul_drivers >li>p[title='li_edit']").click(function(){
								window.open("logup_Step2_driver.html?usertype=super&upload=&sessionName=idcard_num"+$(this).parent().attr("index"),"_blank");
							});
							$("#id_ul_drivers >li>p[title='li_delete']").click(function(){
								if (window.confirm("确认删除该驾驶员？")) {
									var sessionName = "idcard_num"+$(this).parent().attr("index");
									var request = new XMLHttpRequest;
									request.open("POST","../ajax/WriteDB.php?",true);
									request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
									request.send("sessionName="+sessionName+"&flag=delete_driver");
									request.onreadystatechange = function(){
										if (request.readyState===4) {
											if (request.status===200) {
												console.log(request.responseText);
												var response = JSON.parse(request.responseText);
												if (response.success==true) {
													alert("删除成功");
													getDriverUl();
												}else{
													console.log(response.reason);
													alert("删除失败"+response.reason);
												}
											}else{
												alert("error:"+request.status);
											}
										}
									}
								}
							});
							$("#id_admin_driver").css("display","flex");
						});
					}else{
						alert("error:"+request.status);
					}
				}
			}
		}
		function addDriver(){
			window.open("logup_Step2_driver.html?usertype=super&pic=","_blank");
		}
		function searchDriver(){
			var sql = "select idcard_num,username,sex,job_permi_classify,ifblock,star_polite,star_safe,star_law,star_honest,star_server from tb_driver where ";
			var selectOptions = document.getElementById("id_options_driver");
			var sindex = selectOptions.selectedIndex;
			var reference = selectOptions.options[sindex].value;
			var where = document.getElementById("id_where_driver").value;
			switch(reference){
				case '姓名':
					sql = sql+"username like '%"+where+"%';";
					break;
				case '性别':
					sql = sql+"sex like '%"+where+"%';";
					break;
				case '驾驶证号':
					sql = sql+"driveLicence_id like '%"+where+"%';";
					break;
				case '档案编号':
					sql = sql+"driverLicence_num like '%"+where+"%';"
					break;
				case '从业资格证号':
					sql = sql+"job_permi_id like '%"+where+"%';";
					break;
				case '联系电话':
					sql = sql+"phonenum like '%"+where+"%';";
					break;
			}
			var request = new XMLHttpRequest;
			request.open("GET","../ajax/getData_sql.php?flag=dosql&sql="+sql,true);
			request.send();
			request.onreadystatechange = function(){
				if (request.readyState===4) {
					if (request.status===200) {
						var result = JSON.parse(request.responseText);
						console.log(result);
						var inner="";
						if (result.length>0) {
							inner = inner+'<li class="li_content" style="border-bottom:solid 1px #888;justify-content:flex-start;"><p class="text_normal" style="width: 80px;">姓名</p><p class="text_normal" style="width: 40px;margin-left: 10px;">性别</p><p class="text_normal" style="width: 140px;margin-left: 20px;margin-right:25px;">从业资格类别</p><p class="text_normal" style="width: 83px;text-align:center;">文明星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">安全星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">守法星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">诚信星</p><p class="text_normal" style="width: 83px;margin-left:20px;text-align:center;">服务星</p></li>';
							for (var m = 0; m<result.length; m++) {
								var j = "list"+m;
								inner = inner+'<li class="li_content" index="'+m+'"><p class="text_normal" style="width: 90px;">'+result[j]['username']+'</p><p class="text_normal" style="width: 15px;margin-left: 20px;">'+result[j]['sex']+'</p><p class="text_normal" style="width: 140px;margin-left: 20px;margin-right:25px;">'+result[j]['job_permi_classify']+'</p>';
								var ifblock = result[j]['ifblock'];
								if (ifblock==1) {
									inner = inner+'<p class="text_normal" style="width: 430px;margin-left: 20px;">该驾驶员在黑名单中';
								}else{
									var star_polite = result[j]['star_polite'];
									var i=1;
									while(i<=star_polite){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_polite++;
									while(star_polite<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_polite++;
									}

									var star_safe = result[j]['star_safe'];
									if (star_safe>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										star_safe++;
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
									}
									i=2;
									while(i<=star_safe){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_safe++;
									while(star_safe<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_safe++;
									}
									var star_law = result[j]['star_law'];
									if (star_law>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
										star_law++;
									}
									i=2;
									while(i<=star_law){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_law++;
									while(star_law<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_law++;
									}
									var star_honest = result[j]['star_honest'];
									if (star_honest>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
										star_honest++
									}
									i=2;
									while(i<=star_honest){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_honest++;
									while(star_honest<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_honest++;
									}
									var star_server = result[j]['star_server'];
									if (star_server>0) {
										inner = inner+'<img class="img_star" src="../images/star_gold.png" style="margin-left:20px;">';
									}else{
										inner = inner+'<img class="img_star" src="../images/star_gray.png" style="margin-left:20px;">';
										star_server++;
									}
									i=2;
									while(i<=star_server){
										inner = inner+'<img class="img_star" src="../images/star_gold.png">';
										i++;
									}
									star_server++;
									while(star_server<=5){
										inner = inner+'<img class="img_star" src="../images/star_gray.png">';
										star_server++
									}
								}
								inner = inner+ '<p class="p_btn" title="li_edit">编辑</p><p class="p_btn" title="li_delete" >删除</p></li>';
							}
						}else{
							console.log(result.reason);
						}
						$(function(){
							$("#id_ul_drivers").html(inner);
							$("#id_ul_drivers >li:even").css("background-color","rgba(220,220,220,0.8)");
							$("#id_ul_drivers >li").mouseover(function(){$(this).css("background-color","rgba(230,230,230,0.9)")});
							$("#id_ul_drivers >li:even").mouseout(function(){$(this).css("background-color","rgba(220,220,220,0.8)")});
							$("#id_ul_drivers >li:odd").mouseout(function(){$(this).css("background-color","rgba(250,250,250,0.9)")});
							$("#id_ul_drivers >li>p[title='li_edit']").prevAll().click(function(){
								window.open("show_driver_one.html?sessionName=idcard_num"+$(this).parent().attr("index"),"_blank");
							});
							$("#id_ul_drivers >li>p[title='li_edit']").click(function(){
								window.open("logup_Step2_driver.html?usertype=super&upload=&sessionName=idcard_num"+$(this).parent().attr("index"),"_blank");
							});
							$("#id_ul_drivers >li>p[title='li_delete']").click(function(){
								if (window.confirm("确认删除该驾驶员？")) {
									var sessionName = "idcard_num"+$(this).parent().attr("index");
									var request = new XMLHttpRequest;
									request.open("POST","../ajax/WriteDB.php?",true);
									request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
									request.send("sessionName="+sessionName+"&flag=delete_driver");
									request.onreadystatechange = function(){
										if (request.readyState===4) {
											if (request.status===200) {
												console.log(request.responseText);
												var response = JSON.parse(request.responseText);
												if (response.success==true) {
													alert("删除成功");
													getDriverUl();
												}else{
													console.log(response.reason);
													alert("删除失败"+response.reason);
												}
											}else{
												alert("error:"+request.status);
											}
										}
									}
								}
							});
							$("#id_admin_driver").css("display","flex");
						});
					}else{
						alert("error:"+request.status);
					}
				}
			}
		}
	</script>
</body>
</html>